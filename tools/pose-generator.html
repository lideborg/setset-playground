<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pose Generator</title>
    <link rel="stylesheet" href="/shared/css/tokens.css">
    <link rel="stylesheet" href="/shared/css/base.css">
    <link rel="stylesheet" href="/shared/css/components.css">
    <style>
        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: var(--space-lg);
        }

        header {
            margin-bottom: var(--space-lg);
        }

        header h1 {
            font-size: 1.5rem;
            font-weight: 500;
            margin-bottom: var(--space-xs);
        }

        header p {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Layout */
        .layout {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }

        /* Top controls */
        .top-controls {
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            padding: var(--space-md);
        }

        .controls-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-sm);
        }

        .controls-header h3 {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            margin: 0;
        }

        .controls-row {
            display: flex;
            gap: var(--space-md);
            align-items: flex-start;
            flex-wrap: wrap;
        }

        /* Selection buttons */
        .selection-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-xs);
            margin-bottom: var(--space-sm);
        }

        .selection-buttons .btn {
            font-size: 0.7rem;
            padding: 4px 8px;
            height: auto;
        }

        /* Category tabs */
        .category-tabs {
            display: flex;
            gap: var(--space-xs);
            margin-bottom: var(--space-sm);
            flex-wrap: wrap;
        }

        .category-tab {
            padding: 6px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.15s;
        }

        .category-tab:hover {
            border-color: var(--text-tertiary);
        }

        .category-tab.active {
            background: rgba(0, 100, 255, 0.15);
            border-color: rgba(0, 100, 255, 0.4);
        }

        .category-tab .count {
            font-size: 0.65rem;
            color: var(--text-tertiary);
            margin-left: 4px;
        }

        /* Pose grid (horizontal) */
        .pose-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            flex: 1;
        }

        .pose-chip {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.15s;
            font-size: 0.75rem;
        }

        .pose-chip:hover {
            border-color: var(--text-tertiary);
        }

        .pose-chip input[type="checkbox"] {
            display: none;
        }

        .pose-chip.selected {
            background: rgba(0, 100, 255, 0.15);
            border-color: rgba(0, 100, 255, 0.4);
        }

        .pose-chip .pose-code {
            font-family: monospace;
            font-size: 0.65rem;
            color: var(--text-tertiary);
        }

        .pose-chip .pose-label {
            color: var(--text-primary);
        }

        .pose-chip .pose-category {
            font-size: 0.6rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
        }

        /* Settings section */
        .settings-section {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            min-width: fit-content;
        }

        .settings-section label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .settings-section input {
            width: 50px;
            padding: 4px 8px;
            font-size: 0.875rem;
            text-align: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
        }

        .settings-section .hint {
            font-size: 0.65rem;
            color: var(--text-tertiary);
        }

        .stats-inline {
            display: flex;
            gap: var(--space-md);
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .stats-inline span {
            white-space: nowrap;
        }

        .stats-inline strong {
            color: var(--text-primary);
        }

        /* Action buttons */
        .action-buttons {
            display: flex;
            gap: var(--space-xs);
        }

        /* Progress */
        .progress-section {
            display: none;
            flex: 1;
            max-width: 300px;
        }

        .progress-section.visible {
            display: block;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--space-xs);
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        .progress-bar-bg {
            height: 4px;
            background: var(--border-primary);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: var(--accent-primary);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Main content */
        .main-content {
            min-width: 0;
        }

        /* Results Grid */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: var(--space-sm);
        }

        .result-card {
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            overflow: hidden;
            border: 1px solid var(--border-primary);
        }

        .result-card.generating {
            opacity: 0.7;
        }

        .result-card.generating .result-placeholder {
            background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--bg-secondary) 50%, var(--bg-tertiary) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .result-image {
            width: 100%;
            aspect-ratio: 3/4;
            object-fit: cover;
            display: block;
        }

        .result-placeholder {
            width: 100%;
            aspect-ratio: 3/4;
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-tertiary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .result-info {
            padding: var(--space-sm);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            margin-bottom: 4px;
        }

        .result-code {
            font-family: monospace;
            font-size: 0.625rem;
            color: var(--text-tertiary);
            background: var(--bg-tertiary);
            padding: 2px 6px;
            border-radius: var(--radius-sm);
        }

        .result-category {
            font-size: 0.625rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
        }

        .result-name {
            font-size: 0.75rem;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .result-gender {
            font-size: 0.65rem;
            color: var(--text-tertiary);
        }

        .result-actions {
            display: flex;
            gap: var(--space-xs);
            margin-top: var(--space-xs);
        }

        .result-actions .btn {
            flex: 1;
            font-size: 0.65rem;
            padding: 4px;
            height: auto;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: var(--space-xl);
            color: var(--text-secondary);
        }

        .empty-state p {
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Pose Generator</h1>
            <p>Select poses to generate reference images (92 poses: 50 original + 42 Setset, male & female versions)</p>
        </header>

        <div class="layout">
            <!-- Top Controls -->
            <div class="top-controls">
                <div class="controls-header">
                    <h3>Select Poses</h3>
                    <div class="selection-buttons">
                        <button class="btn btn--secondary" id="select-all-btn">All 92</button>
                        <button class="btn btn--secondary" id="select-original-btn">Original 50</button>
                        <button class="btn btn--secondary" id="select-setset-btn">Setset 42</button>
                        <button class="btn btn--secondary" id="deselect-all-btn">None</button>
                        <button class="btn btn--secondary" id="select-random-10-btn">Random 10</button>
                        <button class="btn btn--secondary" id="select-troubleshoot-btn" style="background: #ff6b6b; color: white;">Troubleshoot</button>
                    </div>
                </div>

                <!-- Category tabs -->
                <div class="category-tabs" id="category-tabs"></div>

                <!-- Pose chips -->
                <div class="pose-grid" id="pose-checklist"></div>
            </div>

            <!-- Settings Bar -->
            <div class="top-controls">
                <div class="controls-row">
                    <div class="settings-section">
                        <label>Images per pose:</label>
                        <input type="number" id="images-per-pose" value="1" min="1" max="10">
                        <span class="hint">(x2 genders)</span>
                    </div>

                    <div class="stats-inline">
                        <span>Selected: <strong id="selected-count">0</strong></span>
                        <span>Total images: <strong id="total-images-count">0</strong></span>
                        <span>Generated: <strong id="generated-count">0</strong></span>
                    </div>

                    <div class="progress-section" id="progress-section">
                        <div class="progress-header">
                            <span id="progress-status">Generating...</span>
                            <span id="progress-count">0 / 0</span>
                        </div>
                        <div class="progress-bar-bg">
                            <div class="progress-bar-fill" id="progress-bar"></div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn--primary" id="generate-btn">Generate</button>
                        <button class="btn btn--secondary" id="download-all-btn" disabled>Download All</button>
                    </div>
                </div>
            </div>

            <!-- Results Grid -->
            <div class="main-content">
                <div class="results-grid" id="results-grid">
                    <div class="empty-state">
                        <p>Select poses above and click Generate</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/shared/js/api.js"></script>
    <script src="/shared/data/editorial-poses.js"></script>
    <script>
        // Global state
        const state = {
            poses: [],           // 50 base poses
            selected: new Set(), // selected pose IDs
            results: {},         // generated results keyed by unique filename
            generating: false,
            activeCategory: 'all' // filter by category
        };

        let api, elements;

        // Build pose list with codes (original 50 + setset 42 = 92 total)
        function buildPoseList() {
            // Original poses (1-50)
            const originalPoses = EDITORIAL_POSES_FEMALE.map((pose, idx) => ({
                ...pose,
                index: idx + 1,
                code: String(idx + 1).padStart(2, '0'),
                isSetset: false
            }));

            // Setset poses (51-92)
            const setsetPoses = SETSET_POSES_FEMALE.map((pose, idx) => ({
                ...pose,
                index: idx + 51,
                code: String(idx + 51).padStart(2, '0'),
                isSetset: true
            }));

            return [...originalPoses, ...setsetPoses];
        }

        // Get images per pose setting
        function getImagesPerPose() {
            return parseInt(elements.imagesPerPose.value) || 1;
        }

        // Render category tabs
        function renderCategoryTabs() {
            const allCount = state.poses.length;
            const originalCount = EDITORIAL_POSES_FEMALE.length;
            const setsetCount = SETSET_POSES_FEMALE.length;

            let html = `<div class="category-tab ${state.activeCategory === 'all' ? 'active' : ''}" data-category="all">
                All <span class="count">(${allCount})</span>
            </div>`;

            // Original categories
            html += `<div style="margin-left: 8px; border-left: 1px solid var(--border-primary); padding-left: 8px; display: flex; gap: 4px;">`;
            for (const cat of POSE_CATEGORIES) {
                const isActive = state.activeCategory === cat.id;
                html += `<div class="category-tab ${isActive ? 'active' : ''}" data-category="${cat.id}">
                    ${cat.name} <span class="count">(${cat.count})</span>
                </div>`;
            }
            html += `</div>`;

            // Setset categories
            html += `<div style="margin-left: 8px; border-left: 1px solid var(--border-primary); padding-left: 8px; display: flex; gap: 4px;">`;
            for (const cat of SETSET_POSE_CATEGORIES) {
                const isActive = state.activeCategory === cat.id;
                html += `<div class="category-tab ${isActive ? 'active' : ''}" data-category="${cat.id}">
                    ${cat.name} <span class="count">(${cat.count})</span>
                </div>`;
            }
            html += `</div>`;

            elements.categoryTabs.innerHTML = html;

            // Add click handlers
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    state.activeCategory = tab.dataset.category;
                    renderCategoryTabs();
                    renderChecklist();
                });
            });
        }

        // Render pose chips
        function renderChecklist() {
            const filteredPoses = state.activeCategory === 'all'
                ? state.poses
                : state.poses.filter(p => p.category === state.activeCategory);

            elements.poseChecklist.innerHTML = filteredPoses.map(pose => `
                <label class="pose-chip ${state.selected.has(pose.id) ? 'selected' : ''}" data-id="${pose.id}">
                    <input type="checkbox" ${state.selected.has(pose.id) ? 'checked' : ''}>
                    <span class="pose-code">${pose.code}</span>
                    <span class="pose-label">${pose.name}</span>
                </label>
            `).join('');

            // Add event listeners
            document.querySelectorAll('.pose-chip').forEach(chip => {
                chip.addEventListener('click', function(e) {
                    e.preventDefault();
                    const id = this.dataset.id;
                    if (state.selected.has(id)) {
                        state.selected.delete(id);
                        this.classList.remove('selected');
                    } else {
                        state.selected.add(id);
                        this.classList.add('selected');
                    }
                    updateStats();
                });
            });

            updateStats();
        }

        // Update stats
        function updateStats() {
            const imagesPerPose = getImagesPerPose();
            const totalImages = state.selected.size * 2 * imagesPerPose; // x2 for both genders
            elements.selectedCount.textContent = state.selected.size;
            elements.totalImagesCount.textContent = totalImages;
            elements.generatedCount.textContent = Object.keys(state.results).length;
            elements.generateBtn.disabled = state.selected.size === 0 || state.generating;
            elements.downloadAllBtn.disabled = Object.keys(state.results).length === 0;
        }

        // Render results grid
        function renderResults() {
            const results = Object.entries(state.results);

            if (results.length === 0) {
                elements.resultsGrid.innerHTML = `
                    <div class="empty-state">
                        <p>Select poses and click Generate</p>
                    </div>
                `;
                return;
            }

            elements.resultsGrid.innerHTML = results.map(([filename, result]) => `
                <div class="result-card" data-filename="${filename}">
                    <img class="result-image" src="${result.url}" alt="${result.name}">
                    <div class="result-info">
                        <div class="result-header">
                            <span class="result-code">${result.code}</span>
                            <span class="result-category">${result.category}</span>
                        </div>
                        <div class="result-name">${result.name}</div>
                        <div class="result-gender">${result.gender === 'female' ? 'Female' : 'Male'}</div>
                        <div class="result-actions">
                            <button class="btn btn--secondary" onclick="regenerateSingle('${filename}')">Redo</button>
                            <button class="btn btn--secondary" onclick="downloadSingle('${filename}')">Download</button>
                        </div>
                    </div>
                </div>
            `).join('');

            updateStats();
        }

        // Add generating placeholder
        function addGeneratingPlaceholder(genTask) {
            // Remove empty state if present
            const emptyState = elements.resultsGrid.querySelector('.empty-state');
            if (emptyState) emptyState.remove();

            // Check if card already exists
            let card = elements.resultsGrid.querySelector(`[data-filename="${genTask.filename}"]`);
            if (!card) {
                const html = `
                    <div class="result-card generating" data-filename="${genTask.filename}">
                        <div class="result-placeholder">${genTask.code}</div>
                        <div class="result-info">
                            <div class="result-header">
                                <span class="result-code">${genTask.code}</span>
                            </div>
                            <div class="result-name">${genTask.name}</div>
                            <div class="result-gender">${genTask.gender === 'female' ? 'Female' : 'Male'}</div>
                        </div>
                    </div>
                `;
                elements.resultsGrid.insertAdjacentHTML('beforeend', html);
            }
        }

        // Update card with result
        function updateCardWithResult(filename, result) {
            const card = elements.resultsGrid.querySelector(`[data-filename="${filename}"]`);
            if (card) {
                card.classList.remove('generating');
                card.innerHTML = `
                    <img class="result-image" src="${result.url}" alt="${result.name}">
                    <div class="result-info">
                        <div class="result-header">
                            <span class="result-code">${result.code}</span>
                            <span class="result-category">${result.category}</span>
                        </div>
                        <div class="result-name">${result.name}</div>
                        <div class="result-gender">${result.gender === 'female' ? 'Female' : 'Male'}</div>
                        <div class="result-actions">
                            <button class="btn btn--secondary" onclick="regenerateSingle('${filename}')">Redo</button>
                            <button class="btn btn--secondary" onclick="downloadSingle('${filename}')">Download</button>
                        </div>
                    </div>
                `;
            }
        }

        // Get prompt for a pose and gender
        function getPromptForPose(poseId, gender, isSetset) {
            let poses;
            if (isSetset) {
                poses = gender === 'female' ? SETSET_POSES_FEMALE : SETSET_POSES_MALE;
            } else {
                poses = gender === 'female' ? EDITORIAL_POSES_FEMALE : EDITORIAL_POSES_MALE;
            }
            const pose = poses.find(p => p.id === poseId);
            return pose ? pose.prompt : null;
        }

        // Generate single task
        async function generateSingle(genTask) {
            addGeneratingPlaceholder(genTask);

            try {
                const prompt = getPromptForPose(genTask.pose.id, genTask.gender, genTask.pose.isSetset);
                if (!prompt) {
                    console.error(`No prompt found for ${genTask.pose.id} ${genTask.gender}`);
                    return null;
                }

                console.log(`Generating: ${genTask.code} ${genTask.name} (${genTask.gender})`);

                const data = await api.generateImage('reve', {
                    prompt: prompt,
                    aspect_ratio: '3:4',
                    num_images: 1,
                    output_format: 'png'
                });

                if (data.images && data.images.length > 0) {
                    const result = {
                        url: data.images[0].url,
                        code: genTask.code,
                        name: genTask.name,
                        gender: genTask.gender,
                        category: genTask.pose.category,
                        pose: genTask.pose,
                        prompt: prompt
                    };
                    state.results[genTask.filename] = result;
                    updateCardWithResult(genTask.filename, result);
                    console.log(`   Done: ${genTask.code}`);
                    return result;
                }
            } catch (error) {
                console.error(`   Failed: ${genTask.code}`, error);
            }
            return null;
        }

        // Regenerate single
        async function regenerateSingle(filename) {
            const result = state.results[filename];
            if (!result) return;

            const genTask = {
                pose: result.pose,
                gender: result.gender,
                code: result.code,
                name: result.name,
                filename: filename
            };

            delete state.results[filename];
            await generateSingle(genTask);
            updateStats();
        }

        // Build generation tasks from selected poses
        function buildGenerationTasks() {
            const tasks = [];
            const imagesPerPose = getImagesPerPose();
            const selectedPoses = state.poses.filter(p => state.selected.has(p.id));

            for (const pose of selectedPoses) {
                for (const gender of ['female', 'male']) {
                    for (let i = 1; i <= imagesPerPose; i++) {
                        const genderCode = gender === 'female' ? 'F' : 'M';
                        const code = `${pose.code}${genderCode}${i}`;
                        tasks.push({
                            pose: pose,
                            gender: gender,
                            variationIndex: i,
                            code: code,
                            name: pose.name,
                            filename: `pose_${code}_${pose.id}.png`
                        });
                    }
                }
            }
            return tasks;
        }

        // Generate all selected
        async function generateSelected() {
            if (state.generating || state.selected.size === 0) return;
            state.generating = true;

            elements.generateBtn.disabled = true;
            elements.progressSection.classList.add('visible');

            const tasks = buildGenerationTasks();
            const total = tasks.length;
            let completed = 0;

            console.log(`\nStarting generation of ${total} images (${state.selected.size} poses x 2 genders x ${getImagesPerPose()} each)...`);

            elements.progressCount.textContent = `0 / ${total}`;
            elements.progressBar.style.width = '0%';

            const MAX_CONCURRENT = 5;
            const executing = new Set();

            for (const task of tasks) {
                const promise = (async () => {
                    await generateSingle(task);
                    completed++;
                    elements.progressCount.textContent = `${completed} / ${total}`;
                    elements.progressBar.style.width = `${(completed / total) * 100}%`;
                    updateStats();
                })();

                const wrapped = promise.then(() => executing.delete(wrapped));
                executing.add(wrapped);

                if (executing.size >= MAX_CONCURRENT) {
                    await Promise.race(executing);
                }
            }

            await Promise.all(executing);

            console.log(`\nGeneration complete!`);
            elements.progressStatus.textContent = 'Complete!';
            state.generating = false;
            elements.generateBtn.disabled = false;
        }

        // Download single
        async function downloadSingle(filename) {
            const result = state.results[filename];
            if (!result) return;

            try {
                const response = await fetch(result.url);
                const blob = await response.blob();
                const url = URL.createObjectURL(blob);

                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error('Download failed:', error);
            }
        }

        // Download all
        async function downloadAll() {
            const results = Object.entries(state.results);
            console.log(`Downloading ${results.length} images...`);

            for (const [filename, result] of results) {
                await downloadSingle(filename);
                await new Promise(r => setTimeout(r, 300));
            }

            console.log('All downloads complete!');
        }

        // Selection helpers
        function selectAll() {
            state.poses.forEach(p => state.selected.add(p.id));
            renderChecklist();
        }

        function selectOriginal() {
            state.selected.clear();
            state.poses.filter(p => !p.isSetset).forEach(p => state.selected.add(p.id));
            renderChecklist();
        }

        function selectSetset() {
            state.selected.clear();
            state.poses.filter(p => p.isSetset).forEach(p => state.selected.add(p.id));
            renderChecklist();
        }

        function deselectAll() {
            state.selected.clear();
            renderChecklist();
        }

        function selectRandom10() {
            state.selected.clear();
            const shuffled = [...state.poses].sort(() => Math.random() - 0.5);
            shuffled.slice(0, 10).forEach(p => state.selected.add(p.id));
            renderChecklist();
        }

        // Troubleshoot - select poses that need testing/fixing
        function selectTroubleshoot() {
            state.selected.clear();
            // List of pose IDs that are being worked on / need testing
            const troubleshootPoses = [
                'setset-studio-arms-behind-back', // Arms behind back - testing
                'setset-studio-leaning-back' // Leaning back casual - new pose
            ];

            state.poses.forEach(p => {
                if (troubleshootPoses.includes(p.id)) {
                    state.selected.add(p.id);
                }
            });
            renderChecklist();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            api = new API();
            elements = {
                categoryTabs: document.getElementById('category-tabs'),
                poseChecklist: document.getElementById('pose-checklist'),
                imagesPerPose: document.getElementById('images-per-pose'),
                selectedCount: document.getElementById('selected-count'),
                totalImagesCount: document.getElementById('total-images-count'),
                generatedCount: document.getElementById('generated-count'),
                generateBtn: document.getElementById('generate-btn'),
                downloadAllBtn: document.getElementById('download-all-btn'),
                resultsGrid: document.getElementById('results-grid'),
                progressSection: document.getElementById('progress-section'),
                progressStatus: document.getElementById('progress-status'),
                progressCount: document.getElementById('progress-count'),
                progressBar: document.getElementById('progress-bar')
            };

            // Build pose list (50 unique poses)
            state.poses = buildPoseList();
            renderCategoryTabs();
            renderChecklist();

            // Selection buttons
            document.getElementById('select-all-btn').addEventListener('click', selectAll);
            document.getElementById('select-original-btn').addEventListener('click', selectOriginal);
            document.getElementById('select-setset-btn').addEventListener('click', selectSetset);
            document.getElementById('deselect-all-btn').addEventListener('click', deselectAll);
            document.getElementById('select-random-10-btn').addEventListener('click', selectRandom10);
            document.getElementById('select-troubleshoot-btn').addEventListener('click', selectTroubleshoot);

            // Images per pose change handler
            elements.imagesPerPose.addEventListener('change', updateStats);

            // Generate button
            elements.generateBtn.addEventListener('click', generateSelected);

            // Download all button
            elements.downloadAllBtn.addEventListener('click', downloadAll);

            console.log('Pose Generator initialized');
            console.log(`   ${state.poses.length} poses loaded (50 original + 42 setset, x2 genders)`);
            console.log(`   Original Categories: ${POSE_CATEGORIES.map(c => c.name).join(', ')}`);
            console.log(`   Setset Categories: ${SETSET_POSE_CATEGORIES.map(c => c.name).join(', ')}`);
        });
    </script>
</body>
</html>
